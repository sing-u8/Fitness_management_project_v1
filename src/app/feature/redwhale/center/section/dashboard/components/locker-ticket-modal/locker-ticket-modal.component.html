<div class="rw-modal-background" #modalBackgroundElement></div>

<div class="rw-modal-wrapper justify-content-center align-items-center" (mouseup)="!isMouseModalDown && onCancel()"
  (mousedown)='resetMouseModalDown()' #modalWrapperElement>
  <div class="rw-modal user-select-none" (mousedown)='onMouseModalDown(); $event.stopPropagation()'>

    <div class="modal-header">
      <div class="header-title">
        <div
          class="icon"
          [class.use] = "lockerTicket?.status == 'use'"
          [class.hold] = "lockerTicket?.status == 'holding'"
          [class.expired] = "lockerTicket?.status == 'expired'"
        >
          <img src="assets/icons/etc/locker-white.svg">
        </div>
        <div class="rw-typo-title2 ticket-name">
          [{{lockerTicket?.locker_category_name}}] {{lockerTicket?.locker_item_name}}
        </div>
        <div
          class="status"
          [class.use] = "lockerTicket?.status == 'use'"
          [class.hold] = "lockerTicket?.status == 'holding'"
          [class.expired] = "lockerTicket?.status == 'expired'"
        >
          <span class="rw-typo-bodytext2">{{statusMather[lockerTicket?.status]}}</span>
        </div>
      </div>
      <div class="close-button" (click)="onCancel()">
        <img src="assets/icons/etc/close.svg">
      </div>
    </div>

    <div class="modal-content thin-scroll-y-overlay2">

      <div *ngIf="lockerTicket?.holding_reservation_days > 0" class="holding-box">

        <ng-container *ngIf="lockerTicket?.holding_start_date == lockerTicket?.holding_end_date" >
          {{lockerTicket?.holding_reservation_days}}일 후 홀딩 예정 ({{lockerTicket?.holding_start_date | dateFormat:'YYYY.MM.DD'}})
        </ng-container>
        <ng-container *ngIf="lockerTicket?.holding_start_date != lockerTicket?.holding_end_date">
          {{lockerTicket?.holding_reservation_days}}일 후 홀딩 예정 ({{lockerTicket?.holding_start_date | dateFormat:'YYYY.MM.DD'}} - {{lockerTicket?.holding_end_date | dateFormat:'YYYY.MM.DD'}})
        </ng-container>

      </div>

      <div *ngIf="lockerTicket?.status == 'holding'" class="holding-box">
        <ng-container *ngIf="lockerTicket?.holding_start_date == lockerTicket?.holding_end_date" >
          1일간 홀딩 ({{lockerTicket?.holding_start_date | dateFormat:'YYYY.MM.DD'}})
        </ng-container>
        <ng-container *ngIf="lockerTicket?.holding_start_date != lockerTicket?.holding_end_date">
          {{lockerTicket?.holding_remaining_days}}일간 홀딩 ({{lockerTicket?.holding_start_date | dateFormat:'YYYY.MM.DD'}} - {{lockerTicket?.holding_end_date | dateFormat:'YYYY.MM.DD'}})
        </ng-container>
      </div>

      <div class="content-item">
        <div class="rw-typo-subtext0-regular content-name">기간</div>
        <div class="rw-typo-bodytext0 content-value">
          {{lockerTicket?.start_date}} - {{lockerTicket?.end_date}} ({{date | dayDiff}}일)
        </div>
      </div>
      <div class="content-item">
        <div class="rw-typo-subtext0-regular content-name">잔여기간</div>
        <div class="rw-typo-bodytext0 content-value">
          {{lockerTicket?.remaining_days < 0 ? 0 : lockerTicket?.remaining_days}}일 남음 {{lockerTicket?.remaining_days < 0 ? '(' + -(lockerTicket?.remaining_days - 1)+'일 초과)' : ''}}
        </div>
      </div>
      <div class="content-item">
        <div class="rw-typo-subtext0-regular content-name">결제 금액</div>
        <div class="rw-typo-bodytext0 content-value">￦ {{lockerTicket?.price | numberWithCommas}}</div>
      </div>
      <div class="content-item">
        <div class="rw-typo-subtext0-regular content-name">결제 담당자</div>
        <div class="rw-typo-bodytext0 content-value">
          <rw-avatar
            [image]="lockerTicket?.assignee?.picture"
            text="lockerTicket?.assignee?.gym_user_name"
            size="22" fontSize="10"
            backgroundColor="lockerTicket?.assignee?.color"
          ></rw-avatar>
          {{lockerTicket?.assignee?.gym_user_name}}
        </div>
      </div>

    </div>

    <div *ngIf="lockerTicket?.status != 'expired'" class="modal-buttons">
      <div
        class="rw-typo-bodytext0-bold holding-button"
        [class.is-holded] = "lockerTicket?.status == 'holding'"
        (click) = "lockerTicket?.status != 'holding' && onHold()"
      >
        <img *ngIf="lockerTicket?.status != 'holding'"  src="assets/icons/etc/holding.svg">
        <img *ngIf="lockerTicket?.status == 'holding'" src="assets/icons/etc/holding_lightgrey.svg">
        {{lockerTicket?.status == 'holding' ? '홀딩중' : '홀딩'}}
      </div>
      <div class="divider"></div>
      <div
        class="rw-typo-bodytext0-bold move-place-button"
        (click)="onShift()"
      >
        <img src="assets/icons/etc/move-place.svg"> 자리 이동
      </div>
      <div class="divider"></div>
      <div
        class="rw-typo-bodytext0-bold modify-button"
        (click)="onModify()"
      >
        <img src="assets/icons/etc/edit.svg"> 락커 정보 수정
      </div>
    </div>

    <div
      class="remove-ticket-button"
      (click)="onRemove()"
    >
      해당 락커 비우기
    </div>

  </div>
</div>
